---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Fetch all committees
const allCommittees = await getCollection('committees');

// Sort by order
const committees = allCommittees.sort((a, b) => a.data.order - b.data.order);
---

<Layout
  title="Committees - Fells Prospect Community Association"
  description="Learn about the committees that serve the Fells Prospect community and how to get involved."
>
  <!-- Page Header -->
  <section class="relative py-20 md:py-28" style="background: linear-gradient(135deg, #1B365D 0%, #4A7C9D 100%);">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 class="text-5xl md:text-6xl font-bold mb-6" style="font-family: Georgia, serif; color: #FAF8F4;">
        Our Committees
      </h1>
      <p class="text-xl md:text-2xl max-w-3xl mx-auto" style="color: #EFE9DC;">
        Get involved with FPCA committees serving our community
      </p>
    </div>
    <!-- Decorative bottom -->
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1440 60" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full">
        <path d="M0 0L60 5C120 10 240 20 360 23.3C480 27 600 23 720 21.7C840 20 960 20 1080 23.3C1200 27 1320 33 1380 36.7L1440 40V60H0V0Z" fill="#FAF8F4"/>
      </svg>
    </div>
  </section>

  {committees.map((committee, index) => {
    // Alternate background colors
    const isEven = index % 2 === 0;
    const bgColor = isEven ? '#FAF8F4' : 'linear-gradient(to bottom, #EFE9DC, #F5F1E8)';
    const imageBorderColor = isEven ? '#1B365D' : '#C1503D';
    const imageBgColor = isEven ? '#1B365D' : '#C1503D';

    return (
      <section class="py-16 md:py-20" style={`background: ${bgColor};`}>
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
          <!-- Committee Header -->
          <div class="text-center mb-12">
            <div class="inline-block p-4 rounded-full mb-6" style="background: linear-gradient(135deg, #C1503D, #A84636);">
              <!-- Generic folder/layers icon for all committees -->
              <svg class="w-12 h-12" style="color: #FAF8F4;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
              </svg>
            </div>
            <h2 class="text-4xl md:text-5xl font-bold mb-4" style="font-family: Georgia, serif; color: #3D3D3D;">
              {committee.data.name}
            </h2>
            <div class="w-32 h-1 mx-auto" style="background-color: #C1503D;"></div>
          </div>

          <!-- Main Content Grid -->
          <div class="grid md:grid-cols-2 gap-10 items-start mb-12">
            <!-- Text Content -->
            <div>
              <div class="rounded-2xl shadow-xl p-8 md:p-10" style="background: linear-gradient(to bottom right, #F5F1E8, #EFE9DC);">
                <p class="text-lg leading-relaxed" style="color: #3D3D3D;">
                  {committee.data.description}
                </p>
              </div>
            </div>

            <!-- Image -->
            {committee.data.image && (
              <div class="rounded-2xl overflow-hidden shadow-2xl" style={`border: 4px solid ${imageBorderColor};`}>
                <img
                  src={committee.data.image}
                  alt={committee.data.imageAlt || committee.data.name}
                  class="w-full h-full object-cover"
                />
                {committee.data.imageCaption && (
                  <div class="p-4" style={`background-color: ${imageBgColor}; color: #FAF8F4;`}>
                    <p class="text-sm">
                      {committee.data.imageCaption}
                    </p>
                  </div>
                )}
              </div>
            )}
          </div>

          <!-- Activities Section -->
          {committee.data.activities && committee.data.activities.length > 0 && (
            <div>
              {committee.data.sectionHeading && (
                <h3 class="text-3xl md:text-4xl font-bold mb-8 text-center" style="font-family: Georgia, serif; color: #3D3D3D;">
                  {committee.data.sectionHeading}
                </h3>
              )}

              <!-- Activities Grid -->
              <div class="grid md:grid-cols-2 gap-6">
                {committee.data.activities.map((activity, activityIndex) => {
                  // Alternate card colors
                  const isRedCard = activityIndex % 2 === 0;
                  const cardGradient = isRedCard
                    ? 'linear-gradient(135deg, #C1503D, #A84636)'
                    : 'linear-gradient(135deg, #1B365D, #4A7C9D)';
                  const iconColor = isRedCard ? '#C1503D' : '#3D3D3D';

                  return (
                    <div class="rounded-xl shadow-lg p-8 transition-transform hover:scale-105" style={`background: ${cardGradient}; color: #FAF8F4;`}>
                      <div class="w-16 h-16 rounded-full flex items-center justify-center mb-4" style="background-color: #FAF8F4;">
                        <!-- Generic icon for all activities -->
                        <svg class="w-8 h-8" style={`color: ${iconColor};`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg>
                      </div>
                      <h4 class="text-2xl font-bold mb-4" style="font-family: Georgia, serif;">
                        {activity.title}
                      </h4>
                      <div class="prose prose-invert prose-lg max-w-none leading-relaxed" set:html={activity.content} />
                    </div>
                  );
                })}
              </div>
            </div>
          )}
        </div>
      </section>
    );
  })}

  <!-- Call to Action -->
  <section class="py-16 md:py-20" style="background: linear-gradient(135deg, #1B365D 0%, #4A7C9D 100%); color: #FAF8F4;">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl md:text-4xl font-bold mb-6" style="font-family: Georgia, serif;">Want to Get Involved?</h2>
      <p class="text-xl mb-8" style="color: #EFE9DC;">
        Join one of our committees and help make Fells Prospect an even better place to call home!
      </p>
      <a href="/contact" class="inline-block px-8 py-4 font-semibold rounded-lg transition-all shadow-lg text-lg" style="background-color: #FAF8F4; color: #1B365D;" onmouseover="this.style.backgroundColor='#EFE9DC'" onmouseout="this.style.backgroundColor='#FAF8F4'">
        Contact Us to Join
      </a>
    </div>
  </section>
</Layout>

<style>
  /* Ensure proper rendering of markdown content */
  .prose ul {
    list-style-type: disc;
    padding-left: 1.5em;
    margin-top: 1em;
    margin-bottom: 1em;
  }

  .prose ul li {
    margin-bottom: 0.5em;
  }

  .prose p {
    margin-bottom: 1em;
  }
</style>
