---
import Layout from '../layouts/Layout.astro';
import Button from '../components/Button.astro';
import NewsletterForm from '../components/NewsletterForm.astro';
import BlogCard from '../components/BlogCard.astro';
import EventCard from '../components/EventCard.astro';
import { getCollection } from 'astro:content';

// Get latest blog posts (will need sample content first)
const allBlogPosts = await getCollection('blog');
const recentPosts = allBlogPosts
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 3);

// Get upcoming events - filter by actual date, not just isPast flag
const allEvents = await getCollection('events');
const today = new Date();
today.setHours(0, 0, 0, 0); // Reset time to start of day for accurate comparison

const upcomingEvents = allEvents
  .filter(event => {
    const eventDate = new Date(event.data.eventDate);
    eventDate.setHours(0, 0, 0, 0);
    return eventDate >= today; // Only show events today or in the future
  })
  .sort((a, b) => a.data.eventDate.getTime() - b.data.eventDate.getTime()) // Soonest first
  .slice(0, 3);

---

<Layout
  title="Fells Prospect Community Association - FPCA - Baltimore, MD"
  description="Fells Prospect Community Association - Representing residents and businesses in the Baltimore neighborhood encompassing eastern Upper Fells Point and western Canton."
>
  <!-- Hero Section -->
  <section class="relative overflow-hidden" style="background: linear-gradient(135deg, #C1503D 0%, #A84636 100%);">
    <!-- Fox Silhouette - Bottom left emerging -->
    <div class="absolute -bottom-20 left-8 md:left-16 h-[550px] w-auto opacity-15 pointer-events-none" style="filter: brightness(0) saturate(100%) invert(98%) sepia(4%) saturate(352%) hue-rotate(343deg) brightness(103%) contrast(96%);">
      <img src="/images/fox.svg" alt="" class="h-full w-auto" />
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24 relative z-10">
      <div class="grid md:grid-cols-[45%_55%] gap-8 md:gap-12 items-center">
        <!-- Hero Text -->
        <div style="color: #FAF8F4;">
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight" style="font-family: Georgia, serif; color: #FAF8F4;">
            Fells Prospect Community Association
          </h1>
          <h2 class="text-2xl md:text-3xl font-semibold mb-6" style="color: #F5F1E8;">
            Welcome to Fells Prospect
          </h2>
          <p class="text-lg md:text-xl mb-8 leading-relaxed" style="color: #EFE9DC;">
            Fells Prospect is the Baltimore, Maryland neighborhood which encompasses the eastern portion of Upper Fells Point and the western tip of Canton. We are the community association which represents its residents and businesses. Welcome!
          </p>
          <div class="flex flex-col sm:flex-row gap-4">
            <a href="/membership" class="inline-block px-8 py-4 text-center font-semibold rounded-lg transition-all shadow-lg text-lg" style="background-color: #2D5832; color: #FAF8F4;" onmouseover="this.style.backgroundColor='#3A6B3F'" onmouseout="this.style.backgroundColor='#2D5832'">
              Become a Member
            </a>
            <a href="/about" class="inline-block px-8 py-4 text-center font-semibold rounded-lg transition-all border-2 text-lg" style="border-color: #FAF8F4; color: #FAF8F4;" onmouseover="this.style.backgroundColor='rgba(250, 248, 244, 0.1)'" onmouseout="this.style.backgroundColor='transparent'">
              Learn More
            </a>
          </div>
        </div>

        <!-- Hero Image -->
        <div class="rounded-2xl overflow-hidden shadow-2xl" style="border: 4px solid #FAF8F4;">
          <img
            src="/images/header.avif"
            alt="Fells Prospect neighborhood"
            class="w-full object-cover"
          />
        </div>
      </div>
    </div>

    <!-- Decorative bottom wave -->
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-12 md:h-20">
        <path d="M0 0L60 10C120 20 240 40 360 46.7C480 53 600 47 720 43.3C840 40 960 40 1080 46.7C1200 53 1320 67 1380 73.3L1440 80V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0V0Z" fill="#FAF8F4"/>
      </svg>
    </div>
  </section>

  <!-- Upcoming Events -->
  {upcomingEvents.length > 0 && (
    <section class="py-16 md:py-24 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center mb-12">
          <div>
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">Upcoming Events</h2>
            <p class="text-xl text-gray-600">Join us in making a difference</p>
          </div>
          <Button href="/events" variant="outline">View All Events</Button>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {upcomingEvents.map(event => (
            <EventCard
              title={event.data.title}
              description={event.data.description}
              eventDate={event.data.eventDate}
              eventTime={event.data.eventTime}
              location={event.data.location}
              slug={event.slug}
              image={event.data.image}
              imageAlt={event.data.imageAlt}
              registrationLink={event.data.registrationLink}
              isPast={event.data.isPast}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Recent News -->
  {recentPosts.length > 0 && (
    <section class="py-16 md:py-24">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center mb-12">
          <div>
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">Latest News</h2>
            <p class="text-xl text-gray-600">Updates from our community</p>
          </div>
          <Button href="/blog" variant="outline">View All News</Button>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {recentPosts.map(post => (
            <BlogCard
              title={post.data.title}
              description={post.data.description}
              publishDate={post.data.publishDate}
              author={post.data.author}
              slug={post.slug}
              image={post.data.image}
              imageAlt={post.data.imageAlt}
              tags={post.data.tags}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Call to Action -->
  <section class="py-16 md:py-24" style="background: linear-gradient(135deg, #2D5832 0%, #3A6B3F 100%); color: #FAF8F4;">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl md:text-4xl font-bold mb-6" style="font-family: Georgia, serif;">Get Involved</h2>
      <p class="text-xl mb-8 max-w-2xl mx-auto" style="color: #EFE9DC;">
        Join your neighbors in making Fells Prospect a great place to live and work. Become a member and stay connected with your community.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="/membership" class="inline-block px-8 py-3 font-semibold rounded-lg transition-all shadow-lg" style="background-color: #FAF8F4; color: #2D5832;" onmouseover="this.style.backgroundColor='#EFE9DC'" onmouseout="this.style.backgroundColor='#FAF8F4'">
          Become a Member
        </a>
        <a href="/contact" class="inline-block px-8 py-3 font-semibold rounded-lg transition-all border-2" style="border-color: #FAF8F4; color: #FAF8F4;" onmouseover="this.style.backgroundColor='rgba(250, 248, 244, 0.1)'" onmouseout="this.style.backgroundColor='transparent'">
          Contact Us
        </a>
      </div>
    </div>
  </section>

  <!-- Newsletter Signup -->
  <section class="py-16 md:py-24">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <NewsletterForm
        title="Stay Connected"
        description="Get the latest news, event updates, and impact stories delivered to your inbox."
      />
    </div>
  </section>
</Layout>
